import pandas as pd
import numpy as np

#CONNECTION AVEC GOOGLE DRIVE 

from google.colab import drive
drive.mount('drive')

#IMPORT DES DEUX NOUVEAUX DATASET

global_title_movie=pd.read_csv('/content/drive/MyDrive/globaltitle.csv')
explode_title_actor=pd.read_csv('/content/drive/MyDrive/explodetitleactor.csv')

#SUPPRESSION DE LA COLONNE "Unnamed: 0"

global_title_movie=global_title_movie.drop('Unnamed: 0', axis=1)
explode_title_actor=explode_title_actor.drop('Unnamed: 0', axis=1)

#SUPPRESSION DE LA COLONNE "deathYear"

explode_title_actor=explode_title_actor.drop('deathYear', axis=1)

#VERIFICATION DES NAN

global_title_movie.isna().sum()
explode_title_actor.isna().sum() #Des Nan sont présent dans la colonne primaryProfession ! 

#SUPPRESSION DES NAN

explode_title_actor = explode_title_actor.dropna(how="any")

#Verification du type de données

global_title_movie.info()
explode_title_actor.info()

#SUPPRESSION DES LIGNES AVEC \N OU "unknown"

global_title_movie.drop(global_title_movie.loc[global_title_movie["startYear"]=='\\N'].index, inplace=True)
global_title_movie.drop(global_title_movie.loc[global_title_movie["runtimeMinutes"]=='\\N'].index, inplace=True)
global_title_movie.drop(global_title_movie.loc[global_title_movie["averageRating"]=='unknown'].index, inplace=True)
explode_title_actor.drop(explode_title_actor.loc[explode_title_actor["birthYear"]=='\\N'].index, inplace=True)
explode_title_actor.drop(explode_title_actor.loc[explode_title_actor["knownForTitles_list"]=='\\N'].index, inplace=True)

#CONVERSION DES TYPE DE DONNEES 

global_title_movie["startYear"]=pd.to_numeric(global_title_movie["startYear"])
global_title_movie["runtimeMinutes"]=pd.to_numeric(global_title_movie["runtimeMinutes"])
global_title_movie["averageRating"]=pd.to_numeric(global_title_movie["averageRating"])

global_title_movie["numVotes"]=pd.to_numeric(global_title_movie["numVotes"])
global_title_movie["numVotes"] = global_title_movie["numVotes"].astype(int)

explode_title_actor["birthYear"]=pd.to_numeric(explode_title_actor["birthYear"])
