import pandas as pd
import numpy as np
from google.colab import drive


#IMPORTATION DES DATASET

global_title=pd.read_csv('/content/drive/MyDrive/Base de données/globaltitlemovie.csv')
explode_title_actor=pd.read_csv('/content/drive/MyDrive/Base de données/explodetitleactor.csv')

#JOINTURE DES DEUX DATASET

global_title_actor=pd.merge(global_title ,explode_title_actor,how="left", left_on="tconst" , right_on="knownForTitles_list")

#SUPPRESSION DES COLONNES INUTILES

global_title_actor=global_title_actor.drop(["Unnamed: 0_x","Unnamed: 0_y","knownForTitles_list"],axis=1)

#SUPPRESSION DES NaN

global_title_actor = global_title_actor.dropna(how="any")

#CONVERSION DU TYPE DE DONNEE DE LA COLONNE "birthYear"

global_title_actor["birthYear"] = global_title_actor["birthYear"].astype(int)

#CREATION D'UNE COLONNE AGE DE L'ACTEUR

global_title_actor = global_title_actor.assign(Age = global_title_actor["startYear"] - global_title_actor["birthYear"])

#EXPORTATION DE LA DATASET
global_title_actor.to_csv('globaltitleactor.csv')
!cp globaltitleactor.csv "drive/My Drive/"
